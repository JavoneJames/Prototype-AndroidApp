package com.ce301.billcoverprototype;import androidx.annotation.NonNull;import androidx.appcompat.app.AppCompatActivity;import android.app.Dialog;import android.app.ProgressDialog;import android.content.Intent;import android.os.Bundle;import android.view.View;import android.view.Window;import android.view.WindowManager;import android.widget.Button;import android.widget.EditText;import android.widget.Toast;import com.google.android.gms.tasks.OnFailureListener;import com.google.android.gms.tasks.OnSuccessListener;import com.google.firebase.auth.FirebaseAuth;import com.google.firebase.database.DataSnapshot;import com.google.firebase.database.DatabaseError;import com.google.firebase.database.DatabaseReference;import com.google.firebase.database.FirebaseDatabase;import com.google.firebase.database.ValueEventListener;public class AddMember extends AppCompatActivity {   EditText reg_username,reg_email;   Button reg_button;   ProgressDialog progressDialog;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_add_member);        reg_email=findViewById(R.id.register_email);        reg_username=findViewById(R.id.register_username);        reg_button=findViewById(R.id.register_button);        progressDialog=new ProgressDialog(this);        progressDialog.setMessage("Loading....");        reg_button.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                if(reg_email.getText().toString().isEmpty()){                    Toast.makeText(AddMember.this, "Please enter email", Toast.LENGTH_SHORT).show();                    return;                }               progressDialog.show();                addMember(reg_email.getText().toString());            }        });    }    private void addMember(String email) {        FirebaseDatabase.getInstance().getReference().child("Users").orderByChild("email").equalTo(email).addValueEventListener(new ValueEventListener() {            @Override            public void onDataChange(@NonNull DataSnapshot snapshot) {                for (DataSnapshot snapshot1:snapshot.getChildren()){                    if (!FirebaseAuth.getInstance().getCurrentUser().getEmail().equals(email)){                        addUser(snapshot1.getKey(),snapshot1.child("username").getValue(String.class));                        progressDialog.dismiss();                        return;                    }else {                        progressDialog.dismiss();                        Toast.makeText(AddMember.this, "Email not found ..!", Toast.LENGTH_SHORT).show();                    }                }            }            @Override            public void onCancelled(@NonNull DatabaseError error) {                progressDialog.dismiss();//                Toast.makeText(AddMember.this, error.getMessage(), Toast.LENGTH_SHORT).show();            }        });    }    private void addUser(String Uid,String username) {     DatabaseReference ref= FirebaseDatabase.getInstance().getReference().child("Group").child(FirebaseAuth.getInstance().getCurrentUser().getUid());     ref.child(Uid).setValue(username).addOnSuccessListener(new OnSuccessListener<Void>() {            @Override            public void onSuccess(Void aVoid) {                Toast.makeText(AddMember.this, "Member Add Successfully", Toast.LENGTH_SHORT).show();            }        }).addOnFailureListener(new OnFailureListener() {            @Override            public void onFailure(@NonNull Exception e) {//                Toast.makeText(AddMember.this, e.getMessage(), Toast.LENGTH_SHORT).show();            }        });    }}